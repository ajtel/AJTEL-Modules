<modules> <module> <name>EmailMonitor</name> <version>1.0.4</version> <category>Settings</category> <description>Monitors extension status and sends email notifications to groups or individual extensions.</description> <publisher>AJTEL Comunicaciones</publisher> <license>AJTEL Premium</license> <downloadurl>https://github.com/ajtel/EmailMonitor-Repo/raw/main/EmailMonitor-1.0.4.tar.gz</downloadurl> <md5sum>b1de663f56ee8a4a81bfee08b916288c</md5sum> <signature> EOF ``` <ol start="2"> <li> <p><strong>Append the PGP Signature</strong>: You’ve provided the signature, so we’ll append it directly to <code>module.xml</code>. To avoid formatting issues, we’ll use <code>echo</code> with the exact signature you provided:</p> <pre><code class="language-bash">cat &#x3C;&#x3C; 'EOF' >> module.xml </code></pre> </li> </ol> <p>-----BEGIN PGP SIGNATURE----- Version: GnuPG v2.0.22 (GNU/Linux)</p> <p>iQIcBAABAgAGBQJoIl2NAAoJEFUnukAcift0FTAP/AoQAcpLi45zkQwyy0Udwr3h FCaapdgyYR5lCjLiQUjnHFF0cLfFH1VAh91kjUaIES6NJC3Kqnlivch7OXvTVbvG hbxfag8mWpWv+aFA0+Mstozjn3wyIIKp2kUAR5ilqaC5/KpSIn/UoWSjPwzUfHvC wBSwtdKMCpNeH0k2E1sk4Zu6i4BxPP/IpROu/Hl0YByms+s+XOBoMGnLlJ+W6vzw cSJ53puUgH9CYCMam7Mg4SUzSN97IJS+ECgxLovfaAe+ugPFPRFWQMsuH2mF6oVP dzdO8EomzawB1EgV8c9k7I3MrTZrRhPlsHwdQJbhmA2yAkaOT3HFPq4XzvOZ7sCl cEpdvTPRIYjuYnMEtkxjwojpE+1WD5s6DuhSZvkHAk5RjJ9/i5U05eHp84ZlQEnW JLCIEm4kHIO9vmDWDA/klQb447gNx+f+rc8SrjlhqiJjHZJCIyZPZeWVTioUU0bV ztbQZtevZ+OlgFLjwXHH6s6AlGKZkv1N67J72SVfjvUYFUvUHFVd3g0PmFQNZ60F Mh/twRCDJthrtYB80Ij1SeEYFvQ5i0+Vk5dJctk9hbYNtKJ4wnwRKFKaMV83Ka+y 7tq6YCdSjev824Ss07lQetpBI/DONU5aEj6/E78iR6UUVNbRmJsu4UN9rVMdqxfP +THF53ov0+peL//vmFgT =JtSG -----END PGP SIGNATURE----- EOF</p> <pre><code> 3. **Append the Closing Tags**: Now add the closing tags to complete the XML structure: ```bash cat &#x3C;&#x3C; 'EOF' >> module.xml &#x3C;/signature> &#x3C;/module> &#x3C;/modules> EOF </code></pre> <h4>Step 3: Verify the <code>module.xml</code> File</h4> <p>Check the contents of <code>module.xml</code> to ensure it’s correctly formatted:</p> <pre><code class="language-bash">cat module.xml </code></pre> <p>The file should look like this:</p> <pre><code class="language-xml">&#x3C;?xml version="1.0" encoding="UTF-8"?> &#x3C;modules> &#x3C;module> &#x3C;name>EmailMonitor&#x3C;/name> &#x3C;version>1.0.4&#x3C;/version> &#x3C;category>Settings&#x3C;/category> &#x3C;description>Monitors extension status and sends email notifications to groups or individual extensions.&#x3C;/description> &#x3C;publisher>AJTEL Comunicaciones&#x3C;/publisher> &#x3C;license>AJTEL Premium&#x3C;/license> &#x3C;downloadurl>https://github.com/ajtel/EmailMonitor-Repo/raw/main/EmailMonitor-1.0.4.tar.gz&#x3C;/downloadurl> &#x3C;md5sum>b1de663f56ee8a4a81bfee08b916288c&#x3C;/md5sum> &#x3C;signature> -----BEGIN PGP SIGNATURE----- Version: GnuPG v2.0.22 (GNU/Linux) iQIcBAABAgAGBQJoIl2NAAoJEFUnukAcift0FTAP/AoQAcpLi45zkQwyy0Udwr3h FCaapdgyYR5lCjLiQUjnHFF0cLfFH1VAh91kjUaIES6NJC3Kqnlivch7OXvTVbvG hbxfag8mWpWv+aFA0+Mstozjn3wyIIKp2kUAR5ilqaC5/KpSIn/UoWSjPwzUfHvC wBSwtdKMCpNeH0k2E1sk4Zu6i4BxPP/IpROu/Hl0YByms+s+XOBoMGnLlJ+W6vzw cSJ53puUgH9CYCMam7Mg4SUzSN97IJS+ECgxLovfaAe+ugPFPRFWQMsuH2mF6oVP dzdO8EomzawB1EgV8c9k7I3MrTZrRhPlsHwdQJbhmA2yAkaOT3HFPq4XzvOZ7sCl cEpdvTPRIYjuYnMEtkxjwojpE+1WD5s6DuhSZvkHAk5RjJ9/i5U05eHp84ZlQEnW JLCIEm4kHIO9vmDWDA/klQb447gNx+f+rc8SrjlhqiJjHZJCIyZPZeWVTioUU0bV ztbQZtevZ+OlgFLjwXHH6s6AlGKZkv1N67J72SVfjvUYFUvUHFVd3g0PmFQNZ60F Mh/twRCDJthrtYB80Ij1SeEYFvQ5i0+Vk5dJctk9hbYNtKJ4wnwRKFKaMV83Ka+y 7tq6YCdSjev824Ss07lQetpBI/DONU5aEj6/E78iR6UUVNbRmJsu4UN9rVMdqxfP +THF53ov0+peL//vmFgT =JtSG -----END PGP SIGNATURE----- &#x3C;/signature> &#x3C;/module> &#x3C;/modules> </code></pre> <ul> <li><strong>Key Points to Check</strong>: <ul> <li>The <code>&#x3C;signature></code> tag contains the entire PGP signature, including the <code>-----BEGIN PGP SIGNATURE-----</code> and <code>-----END PGP SIGNATURE-----</code> lines.</li> <li>The XML structure is intact (e.g., no missing closing tags, no extra newlines breaking the XML).</li> </ul> </li> </ul> <p>If the file looks correct, you’re ready to proceed. If there are formatting issues, you can edit <code>module.xml</code> manually using <code>nano</code>:</p> <pre><code class="language-bash">nano module.xml </code></pre> <h4>Step 4: Commit and Push to GitHub</h4> <p>Now that <code>module.xml</code> is created with the correct signature, add it to the repository along with the other files:</p> <pre><code class="language-bash">git add module.xml EmailMonitor-1.0.4.tar.gz EmailMonitor-1.0.4.tar.gz.asc mypublickey.asc git commit -m "Add EmailMonitor 1.0.4 module files with correct module.xml" git push origin main </code></pre> <h4>Step 5: Verify on GitHub</h4> <ul> <li>Visit <code>https://github.com/ajtel/EmailMonitor-Repo</code> in your browser.</li> <li>Confirm that the following files are present in the <code>main</code> branch: <ul> <li><code>EmailMonitor-1.0.4.tar.gz</code></li> <li><code>EmailMonitor-1.0.4.tar.gz.asc</code></li> <li><code>mypublickey.asc</code></li> <li><code>module.xml</code></li> </ul> </li> <li>Check the contents of <code>module.xml</code> on GitHub to ensure the signature is correctly included.</li> </ul> <h4>Step 6: Test the Repository in FreePBX</h4> <p>Now that the repository is set up, configure your FreePBX servers to use it and test the installation:</p> <ul> <li><strong>Add the Repository</strong>: <ul> <li>Go to <strong>Admin > Module Admin</strong> in the FreePBX GUI.</li> <li>Click on <strong>Repositories</strong> (or "Check for Updates online" in older versions).</li> <li>Add a new repository: <ul> <li><strong>Repository Name</strong>: <code>AJTEL Email Monitor</code></li> <li><strong>Repository URL</strong>: <code>https://github.com/ajtel/EmailMonitor-Repo/raw/main/module.xml</code></li> </ul> </li> <li>Save and apply the changes.</li> </ul> </li> <li><strong>Import the Public Key</strong>: On the server, import your GPG public key so FreePBX can verify the module’s signature: <pre><code class="language-bash">wget https://github.com/ajtel/EmailMonitor-Repo/raw/main/mypublickey.asc -O /tmp/mypublickey.asc gpg --import /tmp/mypublickey.asc </code></pre> </li> <li><strong>Check for Updates and Install</strong>: <ul> <li>Go back to <strong>Module Admin</strong> and click <strong>Check Online</strong>.</li> <li>The <code>EmailMonitor</code> module should appear under the "Settings" category.</li> <li>Install or update the module: <pre><code class="language-bash">fwconsole ma downloadinstall EmailMonitor fwconsole reload </code></pre> </li> </ul> </li> <li><strong>Verify the Service</strong>: <pre><code class="language-bash">systemctl status monitor_extension.service </code></pre> Ensure it’s <code>active (running)</code>: <pre><code>● monitor_extension.service - Monitor de conexión de extensiones para PBX AJTEL Loaded: loaded (/etc/systemd/system/monitor_extension.service; enabled; vendor preset: disabled) Active: active (running) since Mon 2025-05-12 16:30:00 UTC; 2min ago </code></pre> </li> </ul> <hr> <h3>Notas Adicionales</h3> <ul> <li><strong>Signature Formatting</strong>: The PGP signature has been correctly embedded in <code>module.xml</code>. The process above avoids formatting issues by appending the signature as a separate step.</li> <li><strong>Repository Access</strong>: Ensure the <code>ajtel/EmailMonitor-Repo</code> repository is public so FreePBX can access it. If it’s private, you’ll need to configure GitHub access tokens or make the repository public.</li> <li><strong>Testing</strong>: Test the installation on multiple servers to ensure the repository works as expected. If FreePBX fails to verify the signature, ensure the public key is correctly imported on the server.</li> </ul> <p>Let me know if you encounter any issues while creating <code>module.xml</code>, pushing to GitHub, or testing the repository in FreePBX. I’m here to help!</p></signature></module></modules>
